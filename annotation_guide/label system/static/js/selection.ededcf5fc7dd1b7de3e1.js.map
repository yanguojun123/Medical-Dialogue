{"version":3,"sources":["webpack:///./src/pages/index/selection.js"],"names":["Object","defineProperty","__webpack_exports__","value","vueSelection","bind","el","binding","vnode","fixRange","range","region","compareBoundaryPoints","Range","START_TO_START","setStart","startContainer","startOffset","END_TO_END","setEnd","endContainer","endOffset","document","body","addEventListener","handleMouseUp","parentElement","removeEventListener","rtn","selection","window","getSelection","allStr","fixStr","rangeCount","getRangeAt","createRange","selectNode","END_TO_START","START_TO_END","CheckIntersection","toString","modifiers","fix","copyRange","cloneRange","detach","handleRange"],"mappings":"oDAAAA,OAAAC,eAAAC,EAAA,cAAAC,OAAA,QAAMC,GACJC,KADmB,SACbC,EAAIC,EAASC,GAyDjB,SAASC,EAAUC,EAAOC,GACpBD,EAAME,sBAAsBC,MAAMC,eAAgBH,GAAU,GAC9DD,EAAMK,SAASJ,EAAOK,eAAgBL,EAAOM,aAE3CP,EAAME,sBAAsBC,MAAMK,WAAYP,GAAU,GAC1DD,EAAMS,OAAOR,EAAOS,aAAcT,EAAOU,WA7D7CC,SAASC,KAAKC,iBAAiB,UAK/B,SAASC,IACP,IAAKnB,EAAGoB,cAEN,YADAJ,SAASC,KAAKI,oBAAoB,UAAWF,GAG/C,IAAIG,EAMN,WACE,IAAIC,EAAYC,OAAOC,eACnBH,GACFI,OAAQ,GACRC,OAAQ,IAEV,GAAIJ,EAAUK,WAAa,EAAG,CAC5B,IAAIxB,EAAQmB,EAAUM,WAAW,GAC7BxB,EAASW,SAASc,cAEtB,GADAzB,EAAO0B,WAAW/B,GAuBtB,SAA4BI,EAAOC,GACjC,QAASD,EAAME,sBAAsBC,MAAMyB,aAAc3B,GAAU,GAAKD,EAAME,sBAAsBC,MAAM0B,aAAc5B,GAAU,GAvB5H6B,CAAkB9B,EAAOC,GAE3B,GADAiB,EAAII,OAAStB,EAAM+B,WACflC,EAAQmC,UAAUC,IACpBlC,EAASC,EAAOC,GAChBiB,EAAIK,OAASvB,EAAM+B,WACnBb,EAAIlB,MAAQA,MACP,CACL,IAAIkC,EAAYlC,EAAMmC,aACtBpC,EAASmC,EAAWjC,GACpBiB,EAAIK,OAASW,EAAUH,WACvBG,EAAUE,SACVlB,EAAIlB,MAAQkC,GAIlB,OAAOhB,EA/BGmB,GACVnB,EAAIK,QAAU1B,EAAQJ,MAAM4B,cAAgBxB,EAAQJ,MAAM4B,aAAaH,EAAIK,OAAQL,EAAII,OAAQJ,EAAIlB,WAwD1FN","file":"static/js/selection.ededcf5fc7dd1b7de3e1.js","sourcesContent":["const vueSelection = {\r\n  bind (el, binding, vnode) {\r\n    document.body.addEventListener('mouseup', handleMouseUp)\r\n\r\n    /**\r\n     * handle mouseup event on body\r\n     */\r\n    function handleMouseUp () {\r\n      if (!el.parentElement) {\r\n        document.body.removeEventListener('mouseup', handleMouseUp)\r\n        return\r\n      }\r\n      var rtn = handleRange()\r\n      rtn.fixStr && binding.value.getSelection && binding.value.getSelection(rtn.fixStr, rtn.allStr, rtn.range)\r\n    }\r\n    /**\r\n     * handle range fix\r\n     */\r\n    function handleRange () {\r\n      var selection = window.getSelection()\r\n      var rtn = {\r\n        allStr: '',\r\n        fixStr: ''\r\n      }\r\n      if (selection.rangeCount > 0) {\r\n        var range = selection.getRangeAt(0)\r\n        var region = document.createRange()\r\n        region.selectNode(el)\r\n        if (CheckIntersection(range, region)) {\r\n          rtn.allStr = range.toString()\r\n          if (binding.modifiers.fix) {\r\n            fixRange(range, region)\r\n            rtn.fixStr = range.toString()\r\n            rtn.range = range\r\n          } else {\r\n            var copyRange = range.cloneRange()\r\n            fixRange(copyRange, region)\r\n            rtn.fixStr = copyRange.toString()\r\n            copyRange.detach()\r\n            rtn.range = copyRange\r\n          }\r\n        }\r\n      }\r\n      return rtn\r\n    }\r\n    /**\r\n     * check if the range intersects the region\r\n     * @param {*} range\r\n     * @param {*} region\r\n     */\r\n    function CheckIntersection (range, region) {\r\n      return !(range.compareBoundaryPoints(Range.END_TO_START, region) > 0 || range.compareBoundaryPoints(Range.START_TO_END, region) < 0)\r\n    }\r\n    /**\r\n     * fix the range according to the region\r\n     * @param {*} range\r\n     * @param {*} region\r\n     */\r\n    function fixRange (range, region) {\r\n      if (range.compareBoundaryPoints(Range.START_TO_START, region) < 0) {\r\n        range.setStart(region.startContainer, region.startOffset)\r\n      }\r\n      if (range.compareBoundaryPoints(Range.END_TO_END, region) > 0) {\r\n        range.setEnd(region.endContainer, region.endOffset)\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport default vueSelection\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/index/selection.js"],"sourceRoot":""}